<!-- --- BEGIN COPYRIGHT BLOCK ---
 Copyright (C) 2001 Sun Microsystems, Inc. Used by permission.
 Copyright (C) 2005 Red Hat, Inc.
 All rights reserved.
  --- END COPYRIGHT BLOCK ---  -->
<HEAD><TITLE>User Management</TITLE>

<SCRIPT language=JavaScript>
var didSetDefaults = 0;


function resetForm()
{
    if (document.modForm.dirsvctype[1].checked) {
	document.configuredForRemote = 1;
	document.modForm.host.focus();
	if (document.modForm.port.value == '') {
	    document.modForm.port.value = '389';
	}
    } else {
	document.configuredForRemote = 0;
    }
}

    
function submitModify()
{
    var theForm = document.modForm;

    // verify form fields
    if ( theForm.dirsvctype[1].checked ) {	// remote directory server
	if ( theForm.host.value.length == 0 ) {
	    alert( 'Please provide the host name of the LDAP server.' );
	    return false;
	}
	if ( theForm.port.value.length == 0 ) {
	    alert( 'Please provide the port number of the LDAP server.' );
	    return false;
	}
	if ( theForm.port.value < 1 || theForm.port.value > 65535 ) {
	    alert( 'The port number must be between 1 and 65535.' );
	    return false;
	}
	if ( theForm.basedn.value.length == 0 ) {
	    alert( 'Please provide a base DN.' );
	    return false;
	}
	if ( theForm.bindpw.value.length > 0 &&
		theForm.binddn.value.length == 0 ) {
	    alert( 'Please provide the Bind DN.' );
	    return false;
	}
    }

    theForm.submit();
    return false;
}


function selectedSSL( doSSL )
{
    var theForm = document.modForm;
    var onWrongPort, portDesc;

    // SSL On or SSL Off radio button was clicked on:  offer to set the
    // port to the standard SSL or non-SSL one as appropriate.

    if ( doSSL ) {
	onWrongPort = ( theForm.port.value == 389 );
	portDesc = 'LDAP over SSL';
	stdPort = 636;
    } else {
	onWrongPort = ( theForm.port.value == 636 );
	portDesc = 'LDAP';
	stdPort = 389;
    }

    if ( onWrongPort && confirm( 'The standard port for ' + portDesc + ' is ' +
	    stdPort + '.\nWould you like to switch to the standard port?' )) {
	theForm.port.value = stdPort;
    }
}


function checkForChange()
{
    cTLMsg = 'If you switch to local database mode,\n' +
	    'any configuration data about directory servers\n' +
	    'will be lost.  Go ahead and change to\n' +
	    'local database mode?';
    cTRMsg = 'To use a directory server, you must\n' +
	    'provide the host name, port, and base DN for\n' +
	    'an LDAP directory server.  Go ahead and\n' +
	    'change to directory server mode?';

    if (document.modForm.dirsvctype[0].checked &&
	    document.configuredForRemote) {
	if (confirm(cTLMsg)) {
	    var tmp = document.location.href;
	    if (document.location.search == "?CHANGE") {
		document.location.search = "";
	    } else {
		document.location.href = tmp + "?CHANGE";
	    }
	} else {
	    document.modForm.dirsvctype[1].checked = true;
	}
    } else if (document.modForm.dirsvctype[1].checked &&
	    !document.configuredForRemote) {
	if (confirm(cTRMsg)) {
	    var tmp = document.location.href;
	    if (document.location.search == "?CHANGE") {
		document.location.search = "";
	    } else {
		document.location.href = tmp + "?CHANGE";
	    }
	} else {
	    document.modForm.dirsvctype[0].checked = true;
	}
    }
}

</SCRIPT>

</HEAD>
<!-- BODY "onLoad='resetForm()'" -->

<CENTER><TABLE BORDER="2" CELLPADDING="10" WIDTH="100%">
<TR><TD ALIGN="center" WIDTH="100%">
<FONT SIZE="+2"><B>Configure Directory Service</B></FONT>
</TD></TR></TABLE></CENTER>

<!-- DS_INLINE_POST_RESULTS -->

<FORM METHOD="POST" ACTION="dsconfig" NAME="modForm">
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=100%>
<TR>
<TD ALIGN="right" NOWRAP><B>Obtain Directory Service From:</B></TD>
<TD>
<INPUT TYPE="radio" NAME="dirsvctype"
VALUE="local"
<!-- DS_CHECKED_IF_LOCAL -->
onClick="checkForChange(this);">Local Database
<BR>
<INPUT TYPE="radio" NAME="dirsvctype"
VALUE="remote"
<!-- DS_CHECKED_IF_REMOTE -->
onClick="checkForChange(this);">LDAP Directory Server
</TD>
</TR>
</TABLE>
<HR>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=100%>
<TR><TD COLSPAN="2" ALIGN="center">

<!-- DS_CONFIG_INFO -->
<BR>

</B></TD></TR>

<!-- DS_HOSTNAME_VALUE -->

<!-- DS_PORT_VALUE -->

<!-- DS_SSL_CONFIG_VALUE -->

<!-- DS_BASEDN_VALUE -->

<!-- DS_BINDDN_VALUE -->

<!-- DS_BINDPASSWD_VALUE -->

</TABLE>
<P>

<CENTER><TABLE BORDER="2" WIDTH="100%">
<TR>
<TD WIDTH="33%" ALIGN="center"><INPUT TYPE="button" VALUE=" Save Changes "
    onClick="submitModify()"></TD>
<TD WIDTH=34% ALIGN=center><INPUT TYPE="reset" VALUE=" Reset "
    onClick="resetForm()"></TD>
<TD WIDTH=33% ALIGN=center>
<!-- HELPBUTTON "DSCONFIG" -->
</TD>
</TR></TABLE></CENTER>
</FORM>

<!-- DS_NOCERTFILE_WARNING "<SCRIPT language=JavaScript>alert('For the Users and Groups forms to work over SSL, you need to activate SSL for this Administration Server.\nChoose Encryption|On/Off to do so.');</SCRIPT>" -->

<!-- ENDHTML -->
