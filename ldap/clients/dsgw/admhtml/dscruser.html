<!-- --- BEGIN COPYRIGHT BLOCK ---
 Copyright (C) 2001 Sun Microsystems, Inc. Used by permission.
 Copyright (C) 2005 Red Hat, Inc.
 All rights reserved.
  --- END COPYRIGHT BLOCK ---  -->
<HEAD><TITLE>User Management</TITLE>

<SCRIPT language=JavaScript>
var didSetDefaults = 0;


function resetForm()
{
    didSetDefaults = 0;
    document.addForm.add_givenname.focus();
}

    
function submitAdd()
{
    var theForm = document.addForm;
    var dn, dnSuffix, i, e, prod;

    if ( theForm.add_cn.value.length == 0 ) {
	alert( 'Please provide the user\'s full name.' );
	theForm.add_cn.focus();
	return;
    }
    if ( theForm.add_sn.value.length == 0 ) {
	alert( 'Please provide the user\'s surname.' );
	theForm.add_sn.focus();
	return;
    }
    if ( theForm.add_unique_uid.value.length == 0 ) {
	alert( 'Please choose a user id for this user.' );
	theForm.add_unique_uid.focus();
	return;
    }

    dn = 'cn=' + theForm.add_cn.value;
    if ( theForm.CrLoc.type == 'hidden' ) {
	dnSuffix = unescape( theForm.CrLoc.value );
    } else {
	dnSuffix = unescape(
		theForm.CrLoc.options[ theForm.CrLoc.selectedIndex ].value );
    }
    if ( dnSuffix.length > 0 ) {
	 dn += ', ' + dnSuffix;
    }
    theForm.dn.value = escape(dn);

    // execute selected product-specific default functions
    for ( i = 0; i < theForm.elements.length; ++i ) {
	e = theForm.elements[ i ];
	if ( e.type == 'checkbox' &&
		e.name.substring( 0, 17 ) == 'product_checkbox_' &&
		e.checked ) {
	    prod = e.name.substring( 17, e.name.length );
	    if ( !eval( 'product_setdefaults_' + prod + '(theForm)' )) {
		return;	// submit vetoed by product
	    }
	}
    }

    theForm.submit();
}


function submitAddandEdit()
{
    document.addForm.completion_javascript.value =
	"if (dsmodify_dn.length == 0) document.location.href=\"genscreen?dscruser&info=\" + escape(dsmodify_info); else document.location.href=\"edit/\" + dsmodify_dn + \"?&info=\" + escape(dsmodify_info);";

    submitAdd();
}


function setDefaults()
{
    var theForm = document.addForm;

    if ( theForm.add_cn.value.length == 0 ) {
	theForm.add_cn.value = theForm.add_givenname.value + ' '
		+ theForm.add_sn.value;
	if ( theForm.add_unique_uid.value.length == 0 ) {
	    theForm.add_unique_uid.value =
		    theForm.add_givenname.value.substring(0,1).toLowerCase()
		    + theForm.add_sn.value.toLowerCase();
	}
	didSetDefaults = 1;
    }
}


function skipIfDefaulted()
{
// Make this function a NOP for now since it exercises a bug in NT Navigator
// that makes the interface very confusing (see bug # 40412 in Scopus).
//    var theForm = document.addForm;
//
//    if ( didSetDefaults == 1 ) {
//	didSetDefaults = 0;
//	document.addForm.newpasswd.focus();
//    }
}

</SCRIPT>

</HEAD>
<!-- BODY "onLoad='resetForm()'" -->

<CENTER><TABLE BORDER="2" CELLPADDING="10" WIDTH="100%">
<TR><TD ALIGN="center" WIDTH="100%">
<FONT SIZE="+2"><B>New User</B></FONT>
</TD></TR></TABLE></CENTER>

<!-- DS_LAST_OP_INFO "prefix=<P><FONT SIZE=%22%2B1%22>The user " "suffix=</FONT><HR>" -->

<FORM METHOD="POST" ACTION="domodify" NAME="addForm">

<INPUT TYPE="hidden" NAME="completion_javascript" VALUE="document.location.href=\'genscreen?dscruser&info=\' + escape(dsmodify_info)">

<INPUT TYPE="hidden" NAME="changetype" VALUE="add">
<INPUT TYPE="hidden" NAME="dn" VALUE="">

<INPUT TYPE="hidden" NAME="add_objectClass" VALUE="top">
<INPUT TYPE="hidden" NAME="add_objectClass" VALUE="person">
<INPUT TYPE="hidden" NAME="add_objectClass" VALUE="organizationalPerson">
<INPUT TYPE="hidden" NAME="add_objectClass" VALUE="inetOrgPerson">
<INPUT TYPE="hidden" NAME="quiet" VALUE="true">
<INPUT TYPE="hidden" NAME="desc_uid" VALUE="user id">

<DIV ALIGN="right"><FONT SIZE="-1">* Indicates a required field</FONT></DIV>

<TABLE CELLSPACING="0" BORDER="0">
<TR><TD NOWRAP ALIGN="right"><b>* Given Name (First Name):</b></TD>
<TD><INPUT type="text" name="add_givenname" value="" size=32></TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>* Surname (Last Name):</b></TD>
<TD><INPUT type="text" name="add_sn" value="" size=32
    onBlur="setDefaults()"> </TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>* Full Name:</b></TD>
<TD><INPUT type="text" name="add_cn" value="" size=32
    onFocus="skipIfDefaulted()"></TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>* User ID:</b></TD>
<TD><INPUT type="text" name="add_unique_uid" value="" size=20></TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>Password:</b></TD>
<TD><INPUT type=password name="newpasswd" value="" size=20></TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>Password (Again):</b></TD>
<TD><INPUT type=password name="newpasswdconfirm" value="" size=20></TD></TR>
<TR><TD NOWRAP ALIGN="right"><b>E-Mail Address:</b></TD>
<TD><INPUT type="text" name="add_mail" value="" size=32></TD></TR>
<!-- INCLUDESET dscruser -->
<!-- DS_LOCATIONPOPUP "name=CrLoc" "prefix=<TR><TD NOWRAP ALIGN=%22right%22><b>Add New User To:</b></TD><TD>" "suffix=</TD></TR>" "rootname=the top of the directory" -->
</TABLE>
<P>

<CENTER><TABLE BORDER="2" WIDTH="100%">
<TR>
<TD WIDTH="25%" ALIGN="center"><INPUT TYPE="button" VALUE=" Create User "
    onClick="submitAdd()"></TD>
<TD WIDTH="25%" ALIGN="center">
<INPUT TYPE="button" VALUE=" Create and Edit User "
    onClick="submitAddandEdit()"></TD>
<TD WIDTH=25% ALIGN=center><INPUT TYPE="reset" VALUE=" Reset "
    onClick="resetForm()"></TD>
<TD WIDTH=25% ALIGN=center>
<!-- HELPBUTTON "DSCRUSER" -->
</TD></TR></TABLE></CENTER>
</FORM>

<!-- ENDHTML -->
